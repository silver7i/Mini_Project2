<!DOCTYPE html>
<html lang=ko>

<head>
    <style>
		#canvas { border: 0px solid; }
        body { padding: 25px;  font: 12px "Lucida Grande", Helvetica, Arial, sans-serif; }
        iframe { overflow: hidden; }
        #title { font-weight: bold;  font-size: 12.5px; }
        a { color: #00B7FF; }
    </style>
	<title>Communicate with Arduino</title>
	
	
</head>

<body>
	<h1 style="text-align:center;">Advanced Blind</h1>
	
	<h3 id="clock"></h3>
	<div>
		<p><input type="time" id="cl"></p>
		<p><button onclick="timeSet()">입력</button></p>
		
		<p id="demo"></p>
	</div>
	<p>&nbsp;</p>
	
	<div>
	<a id="auto" href="/a" target="iframe">
		<button>자동모드</button>
	</a>
	<a id="manual" href="/b" target="iframe">
		<button>수동모드</button>
	</a>
	</div>
	&nbsp;
	<div>
		온도?	<input>
	</div>
	&nbsp;
	<div>
		습도?	<input>
	</div>
	&nbsp;
	
	<div>	
		<a id="servo0" href="/servo0" target="iframe">
			<button>0</button>
		</a>
		<a id="servo30" href="/servo30" target="iframe">
			<button>30</button>
		</a>
		<a id="servo60" href="/servo60" target="iframe">
			<button>60</button>
		</a>
		<a id="servo90" href="/servo90" target="iframe">
			<button>90</button>
		</a>
		<a id="servo120" href="/servo120" target="iframe">
			<button>120</button>
		</a>
		<a id="servo150" href="/servo150" target="iframe">
			<button>150</button>
		</a>
		<a id="servo180" href="/servo180" target="iframe">
			<button>180</button>
		</a>
	</div>	
	
	<div style = "float:right;">
		<a id="down" href="/down" target="iframe">
			<button>△</button>
		</a>
	</div>
	<p style = "clear:both;"></p>

	<div style = "float:right;">
		<a id="up" href="/up" target="iframe">
			<button>▽</button>
		</a>
	</div>
	<p style = "clear:both;">&nbsp;</p>


	<table border="0" background="https://img.hankyung.com/photo/202201/01.28639317.1.jpg">
		<tr>
        <td><canvas id="canvas" width="600" height="450"></td>
		</tr>
		
	</table>
	
    <iframe src="about:blank" width="0" height="0" frameborder="0" border="0" marginwidth="0" marginheight="0" name="iframe"></iframe>
    
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
	<script src="/socket.io/socket.io.js"></script>
	
    <script>
	
	
	$(document).ready(function() 
	{
		$(function()
        {
            var val    = 0;
            var oldval = 0;
            
			var socket = io();
				
			socket.on('servo', function( servoStatus ){
				$('#servo').text(servoStatus);
				console.log(servoStatus);
			});
            
			socket.on('adc', function( adcValue ){
				$('#adc').text(adcValue);
				
				oldval = val;
				// val = parseInt(adcValue);
				val = parseInt(adcValue);
				
				var canvas = document.getElementById('canvas');
						
				if (canvas.getContext){
					var ctx = canvas.getContext('2d');
					
					if( val != oldval ) {
					//*	// 512 x 20
						ctx.fillStyle = 'rgb(200, 150, 250)';
						ctx.fillRect(0,   0,    600, val*2.5);	//(x, y, 너비, 높이)
						ctx.clearRect(0, val*2.5, 600, 450);
					//*/
					/*  //  20 x 512
						ctx.fillStyle = 'rgb(255, 255, 255)';
						ctx.fillRect(0, 0, 20, val);
						ctx.fillStyle = 'rgb(0, 200, 0)';
						ctx.fillRect(0, 512-val, 20, val);
					*/
					}
				}
			});
		});
		
	});
	
	function timeSet() {
		var x = document.getElementById("cl").value;
		document.getElementById("demo").innerHTML = x;
	}
	
	var clockTarget = document.getElementById("clock");


	function clock() {
		var date = new Date();
		var month = date.getMonth();
		var clockDate = date.getDate();
		var day = date.getDay();
		var week = ['일', '월', '화', '수', '목', '금', '토'];
		var hours = date.getHours();
		var minutes = date.getMinutes();
		var seconds = date.getSeconds();
		clockTarget .innerText = `${month+1}월 ${clockDate}일 ${week[day]}요일` +

		`${hours < 10 ? `0${hours}` : hours}:${minutes < 10 ? `0${minutes }`  : minutes }:${seconds < 10 ? `0${seconds }`  : seconds }`;
	}
	
	function init() {
	clock();
	setInterval(clock, 1000);
	}
	
	init();
	
	
	</script>

</body>
</html>
